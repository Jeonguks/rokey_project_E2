# Readme.md

### Environment

```
UBUNTU 22.04.5 LTS
ROS2 Humble
ISAACSIM 5.0.0
---
numpy                                1.26.4
PyYAML                               5.4.1
ultralytics                          8.4.7
```

### Install Dependencies

```bash
pip install numpy<=2.0 PyYAML==5.4.1 ultralytics==8.4.7

```

### How to Run

- NOTE: ì•„ì´ìž‘ì‹¬ í™˜ê²½ì„ ì‹¤í–‰ í›„ Playë²„íŠ¼ì„ ëˆ„ë¥¸í›„ ì‹¤í–‰

```bash
cd ~/YOUR/PATH/rokey_project_E2/src/management_stock
python3 stock_target_publisher.py

cd ~/YOUR/PATH/rokey_project_E2/src
python3 task.py
```

# í”„ë¡œì íŠ¸ êµ¬ì¡° ë° íŒŒì¼ ì—­í•  ì •ë¦¬

ë³¸ ë¬¸ì„œëŠ” í˜„ìž¬ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°ì—ì„œ**ëª¨ë“  íŒŒì¼/í´ë”ì˜ ì—­í• **ì„ ì •ë¦¬í•œ ë¬¸ì„œì´ë‹¤.

Isaac Sim ê¸°ë°˜ ì‹œë®¬ë ˆì´ì…˜ í™˜ê²½ì—ì„œ UR10e ë¡œë´‡íŒ” + ìº” ì˜¤ë¸Œì íŠ¸ + ë§µ í™˜ê²½ + YOLO ê¸°ë°˜ ì¸ì‹ + ìž¬ê³  ê¸°ë°˜ íƒ€ê²Ÿ ì„ ì • êµ¬ì¡°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìž‘ì„±ë˜ì—ˆë‹¤.

---

## ðŸ“ asset/

ì‹œë®¬ë ˆì´ì…˜ì— ë¡œë“œë˜ëŠ” **USD ê¸°ë°˜ ìžì‚° ë¦¬ì†ŒìŠ¤ í´ë”**

### ðŸ“„ asset/project_arm.usd

- UR10e ë¡œë´‡íŒ”(+ ê·¸ë¦¬í¼ í¬í•¨) ëª¨ë¸
- Isaac Sim Stageì— Referenceë¡œ ë¡œë“œë˜ëŠ” **í•µì‹¬ ë¡œë´‡ Articulation ìžì‚°**
- `/joint_command` í† í”½ ê¸°ë°˜ ê´€ì ˆ ì œì–´, IK(RMPFlow/Lula), pick & place ì œì–´ì˜ ëŒ€ìƒ
- í”„ë¡œì íŠ¸ ë‚´ ëª¨ë“  ë¡œë´‡ ì œì–´ íŒŒì´í”„ë¼ì¸ì˜ ê¸°ì¤€ ëª¨ë¸

---

### ðŸ“ asset/can/

í”½ì•¤í”Œë ˆì´ìŠ¤ ëŒ€ìƒì´ ë˜ëŠ” **ìº” ì˜¤ë¸Œì íŠ¸ ìžì‚°ë“¤**

### â–¶ ìš´ì˜ìš©(ì‹œë®¬ë ˆì´ì…˜ ì ìš© ëª¨ë¸)

- `Fanta_Can.usd`
- `Pepsi_Can.usd`
- `Pepsi_Max_Can.usd`
- `French_Coke_Can.usd`
- `French_Coke_Light_Can.usd`

ì—­í• :

- ì‹œë®¬ë ˆì´ì…˜ì—ì„œ ì‹¤ì œë¡œ **ì§‘ê³ (Grasp) ì˜®ê¸°ëŠ”(Pick & Place)** ëŒ€ìƒ ì˜¤ë¸Œì íŠ¸
- ë¬¼ë¦¬ ì—”ì§„(PhysX) ê¸°ë°˜ RigidBody + Collision ì ìš©
- YOLO íƒì§€ ê²°ê³¼ì™€ ë§¤í•‘ë˜ëŠ” ì‹¤ì œ ì›”ë“œ ê°ì²´

### â–¶ ë¬¼ë¦¬ ì•ˆì •í™” ëª¨ë¸

- `fixed_can.usd`
- `fixed_can_f.usd`

ì—­í• :

- ë©”ì‹œ ì¶©ëŒ(triangle mesh collision) ë¬¸ì œ í•´ê²°ìš© ìˆ˜ì • ëª¨ë¸
- ë‚´ë¶€ ë‹¨ìˆœ collider(ì‹¤ë¦°ë”/convex hull) ê¸°ë°˜ êµ¬ì¡°
- **ë™ì  ë¬¼ì²´ ì•ˆì •ì„± í™•ë³´ìš© ìš´ì˜ ëª¨ë¸**

### â–¶ ì›ë³¸ ë¦¬ì†ŒìŠ¤ ìžì‚°

- `.usdz` íŒŒì¼ë“¤ (ì˜ˆ: `Pepsi_Can.usdz`, `French_Coke_can.usdz`, `330ml_can_of_Fanta_Coconut.usdz`)

ì—­í• :

- ì™¸ë¶€ ì—ì…‹ ì†ŒìŠ¤ ì›ë³¸
- ë³€í™˜/ì°¸ì¡°/ë°±ì—…ìš© ìžì‚°
- ì‹œë®¬ë ˆì´ì…˜ ì§ì ‘ ì‚¬ìš©ë³´ë‹¤ëŠ” ë¦¬ì†ŒìŠ¤ ë³´ê´€ ëª©ì 

---

## ðŸ“ map/

ì‹œë®¬ë ˆì´ì…˜ ì›”ë“œ(Stage) í™˜ê²½ êµ¬ì„± USD

### ðŸ“„ map/project_map.usd

- ë©”ì¸ í™˜ê²½ ë§µ(Stage)
- ë°”ë‹¥, ì„ ë°˜, ìž‘ì—… ê³µê°„, êµ¬ì¡°ë¬¼ í¬í•¨
- ë¡œë´‡íŒ” + ìº” ì˜¤ë¸Œì íŠ¸ê°€ ë°°ì¹˜ë˜ëŠ” **ê¸°ë³¸ ì‹œë®¬ë ˆì´ì…˜ ì›”ë“œ**
- ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì§ì ‘ ë¡œë“œë˜ëŠ” ê¸°ì¤€ ë§µ íŒŒì¼

### ðŸ“„ map/f_project_map.usd

- `project_map.usd` flattened ë²„ì „

---

## ðŸ“ src/

í”„ë¡œì íŠ¸ì˜ **ì‹¤ì œ ë¡œì§ ì½”ë“œ ì˜ì—­ (ì‹œë®¬ë ˆì´ì…˜ + ì¸ì‹ + ì •ì±… + íƒœìŠ¤í¬)**

---

### ðŸ“„ src/task.py

**ë©”ì¸ íƒœìŠ¤í¬ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸**

ì—­í• :

- ì‹œë®¬ë ˆì´ì…˜ ì „ì²´ íë¦„ ì œì–´
- ë¡œë´‡ ë¡œë“œ
- ë§µ ë¡œë“œ
- ì˜¤ë¸Œì íŠ¸ ìŠ¤í°
- pick & place ì‹œë‚˜ë¦¬ì˜¤ ì‹¤í–‰
- perception(YOLO) + policy(stock) + control(ë¡œë´‡ ì œì–´) í†µí•© ì œì–´ ë ˆì´ì–´

âž¡ï¸ ì „ì²´ ì‹œìŠ¤í…œì˜ ìƒìœ„ ì œì–´ ì§„ìž…ì (Entry Point)

---

## ðŸ“ src/management_stock/

**ìž¬ê³  ê¸°ë°˜ íƒ€ê²Ÿ ê²°ì • ëª¨ë“ˆ (Policy Layer)**

### ðŸ“„ stock.yaml

- í’ˆëª©ë³„ ìž¬ê³  ë°ì´í„°
- ìž„ê³„ê°’(threshold) ê¸°ì¤€ ì •ì˜
- ì‹œë®¬ë ˆì´ì…˜ í™˜ê²½ì˜ ë…¼ë¦¬ì  ìž¬ê³  ìƒíƒœ í‘œí˜„

### ðŸ“„ stock_target_publisher.py

**ìž¬ê³  ê¸°ë°˜ íƒ€ê²Ÿ í´ëž˜ìŠ¤ ê²°ì • ë¡œì§**

ì—­í• :

- `stock.yaml` ì£¼ê¸°ì  ë¡œë“œ
- ìž„ê³„ê°’ ì´í•˜ í’ˆëª© í•„í„°ë§
- ê°€ìž¥ ë¶€ì¡±í•œ í’ˆëª© ì„ ì •
- `/stock/target_class` í† í”½ publish

âž¡ï¸ "ë¬´ì—‡ì„ ì§‘ì„ ê²ƒì¸ê°€"ë¥¼ ê²°ì •í•˜ëŠ” **ì •ì±…(POLICY) ê³„ì¸µ**

---

## ðŸ“ src/object_detector/

**ë¹„ì „ ì¸ì‹ ê³„ì¸µ (Perception Layer)**

### ðŸ“„ best.pt

- YOLO í•™ìŠµ ëª¨ë¸ ê°€ì¤‘ì¹˜
- ìº” í´ëž˜ìŠ¤ íƒì§€ ëª¨ë¸

### ðŸ“„ find_class.py

- YOLO ê²°ê³¼ í›„ì²˜ë¦¬ ìŠ¤í¬ë¦½íŠ¸
- íƒì§€ ê²°ê³¼ í´ëž˜ìŠ¤ í•„í„°ë§/ë§¤í•‘ ë¡œì§

### ðŸ“„ yolo_isaacsim_node.py

**Isaac Sim ì—°ë™ YOLO ì¸ì‹ ë…¸ë“œ**

ì—­í• :

- ì¹´ë©”ë¼ ì´ë¯¸ì§€ ìž…ë ¥ ìˆ˜ì‹ 
- YOLO ì¶”ë¡  ì‹¤í–‰
- ê°ì²´ í´ëž˜ìŠ¤ íƒì§€
- ì¢Œí‘œ ë³€í™˜
- ë¡œë´‡ ì œì–´ ì‹œìŠ¤í…œìœ¼ë¡œ ì¸ì‹ ê²°ê³¼ ì „ë‹¬

âž¡ï¸ "ë¬´ì—‡ì´ ì–´ë””ì— ìžˆëŠ”ê°€"ë¥¼ ì œê³µí•˜ëŠ” **Perception ê³„ì¸µ**

---

# ðŸ§  êµ¬ì¡° ìš”ì•½ ì•„í‚¤í…ì²˜

```
[ YOLO ì¸ì‹ ê³„ì¸µ ]  (src/object_detector)
        â†“
[ íƒ€ê²Ÿ ê²°ì • ê³„ì¸µ ]  (src/management_stock)
        â†“
[ íƒœìŠ¤í¬ ì œì–´ ê³„ì¸µ ] (src/task.py)
        â†“
[ ë¡œë´‡ ì œì–´ ê³„ì¸µ ]  (asset/project_arm.usd + Isaac Sim ì œì–´)
        â†“
[ í™˜ê²½ ê³„ì¸µ ]       (map/project_map.usd)
        â†“
[ ì˜¤ë¸Œì íŠ¸ ìžì‚° ]   (asset/can/*.usd)

```

---

# ðŸ“Œ ì‹œìŠ¤í…œ ë ˆë²¨ ê°œë… êµ¬ì¡°

| ê³„ì¸µ | ì—­í•  |
| --- | --- |
| Perception | YOLO ê¸°ë°˜ ê°ì²´ ì¸ì‹ (ë¬´ì—‡ì´ ìžˆëŠ”ê°€) |
| Policy | ìž¬ê³  ê¸°ë°˜ íƒ€ê²Ÿ ì„ ì • (ë¬´ì—‡ì„ ì§‘ì„ ê²ƒì¸ê°€) |
| Planning | Task orchestration (ì–´ë–¤ ìˆœì„œë¡œ í•  ê²ƒì¸ê°€) |
| Control | ë¡œë´‡íŒ” ê´€ì ˆ/IK ì œì–´ (ì–´ë–»ê²Œ ì›€ì§ì¼ ê²ƒì¸ê°€) |
| World | ë§µ/í™˜ê²½/ë¬¼ë¦¬ ì‹œë®¬ë ˆì´ì…˜ |
| Asset | ë¡œë´‡/ìº”/ë¦¬ì†ŒìŠ¤ ëª¨ë¸ |

---

ì´ êµ¬ì¡°ëŠ” **ë””ì§€í„¸ íŠ¸ìœˆ ê¸°ë°˜ ìžë™í™” ë§¤ìž¥/ì°½ê³  ì‹œë®¬ë ˆì´ì…˜ ì•„í‚¤í…ì²˜**ë¥¼ ì „ì œë¡œ í•œ ê³„ì¸µí˜• ì„¤ê³„ êµ¬ì¡°ì´ë©°,

- perception â†’ policy â†’ task â†’ control â†’ physics/world

ì˜ ì „í˜•ì ì¸ **ë¡œë³´í‹±ìŠ¤ ì‹œìŠ¤í…œ íŒŒì´í”„ë¼ì¸ êµ¬ì¡°**ë¥¼ ë”°ë¥´ê³  ìžˆë‹¤.
